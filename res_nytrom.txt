step 0: train loss 4.2393, val loss 4.2355
iter 0: loss 4.2554, time 344154.80ms, mfu -100.00%, MPS mem allocated=0.81GB, reserved=11.75GB
iter 10: loss 3.2717, time 3511.96ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 20: loss 2.8247, time 3497.22ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 30: loss 2.6317, time 3504.67ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 40: loss 2.5645, time 3749.88ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 50: loss 2.5367, time 3631.97ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 60: loss 2.5211, time 3393.24ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 70: loss 2.5020, time 3465.76ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 80: loss 2.4881, time 3313.46ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 90: loss 2.4818, time 3024.12ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 100: loss 2.4900, time 3236.79ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 110: loss 2.4901, time 3341.97ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 120: loss 2.4705, time 3315.40ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 130: loss 2.4623, time 2979.32ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 140: loss 2.4766, time 3019.78ms, mfu 0.25%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 150: loss 2.4673, time 3631.27ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 160: loss 2.4635, time 3006.05ms, mfu 0.25%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 170: loss 2.4569, time 3725.78ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 180: loss 2.4426, time 3631.59ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 190: loss 2.4471, time 3461.29ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 200: loss 2.4632, time 3045.16ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 210: loss 2.4640, time 3494.49ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 220: loss 2.4353, time 3218.51ms, mfu 0.25%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 230: loss 2.4436, time 3515.86ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 240: loss 2.4408, time 3587.98ms, mfu 0.24%, MPS mem allocated=0.81GB, reserved=11.76GB
step 250: train loss 2.4271, val loss 2.4833
saving checkpoint to out-shakespeare-char
iter 250: loss 2.4294, time 395623.84ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 260: loss 2.4338, time 3269.83ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 270: loss 2.4315, time 3726.91ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 280: loss 2.4307, time 4475.54ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 290: loss 2.4202, time 4008.24ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 300: loss 2.4229, time 3897.39ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 310: loss 2.4221, time 3884.99ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 320: loss 2.4066, time 5059.91ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 330: loss 2.4150, time 3822.29ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 340: loss 2.4079, time 4374.21ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 350: loss 2.4241, time 3957.40ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 360: loss 2.4274, time 3550.67ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 370: loss 2.3922, time 3422.68ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 380: loss 2.3939, time 3885.12ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 390: loss 2.3976, time 4048.04ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 400: loss 2.4028, time 5077.16ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 410: loss 2.4075, time 6203.41ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 420: loss 2.4104, time 4296.43ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 430: loss 2.3940, time 5129.77ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 440: loss 2.3856, time 4044.76ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 450: loss 2.4000, time 4223.28ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 460: loss 2.3532, time 4407.93ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 470: loss 2.3681, time 7149.34ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 480: loss 2.3749, time 3641.71ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 490: loss 2.3586, time 3525.12ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 500: train loss 2.3277, val loss 2.3969
saving checkpoint to out-shakespeare-char
iter 500: loss 2.3674, time 406305.12ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 510: loss 2.3382, time 4948.21ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 520: loss 2.3262, time 4169.18ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 530: loss 2.3047, time 4598.85ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 540: loss 2.3043, time 4840.62ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 550: loss 2.3046, time 3522.11ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 560: loss 2.2970, time 3906.49ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 570: loss 2.2947, time 4065.61ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 580: loss 2.2838, time 4083.31ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 590: loss 2.2841, time 5884.83ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 600: loss 2.2747, time 7015.21ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 610: loss 2.2601, time 5954.46ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 620: loss 2.2563, time 4155.35ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 630: loss 2.2596, time 4484.91ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 640: loss 2.2454, time 4120.99ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 650: loss 2.2626, time 4956.08ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 660: loss 2.2684, time 4486.40ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 670: loss 2.2573, time 4279.21ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 680: loss 2.2144, time 4122.09ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 690: loss 2.1992, time 3966.74ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 700: loss 2.2209, time 5715.77ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 710: loss 2.1891, time 5494.71ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 720: loss 2.2222, time 5465.73ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 730: loss 2.1886, time 4133.57ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 740: loss 2.1904, time 3723.68ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
step 750: train loss 2.1387, val loss 2.2065
saving checkpoint to out-shakespeare-char
iter 750: loss 2.1691, time 398186.36ms, mfu 0.16%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 760: loss 2.1588, time 3624.25ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 770: loss 2.1356, time 3969.47ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 780: loss 2.1107, time 3802.88ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 790: loss 2.0843, time 4097.86ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 800: loss 2.0514, time 3789.91ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 810: loss 1.9862, time 3864.66ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 820: loss 1.9325, time 3665.54ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 830: loss 1.8527, time 4413.82ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 840: loss 1.8218, time 3850.35ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 850: loss 1.7924, time 3920.50ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 860: loss 1.7502, time 3471.00ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 870: loss 1.7244, time 3002.46ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 880: loss 1.6873, time 3446.00ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 890: loss 1.6594, time 3375.23ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 900: loss 1.6243, time 3355.16ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 910: loss 1.6192, time 3784.45ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 920: loss 1.6011, time 3243.50ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 930: loss 1.5703, time 3114.65ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 940: loss 1.5636, time 3061.90ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 950: loss 1.5444, time 2986.96ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 960: loss 1.5170, time 4513.79ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 970: loss 1.5163, time 3550.17ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 980: loss 1.5193, time 3678.11ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 990: loss 1.5125, time 4311.39ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
step 1000: train loss 1.3795, val loss 1.4621
saving checkpoint to out-shakespeare-char
iter 1000: loss 1.4776, time 381178.37ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1010: loss 1.4913, time 3738.52ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1020: loss 1.4990, time 3616.77ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1030: loss 1.4662, time 3619.59ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1040: loss 1.4764, time 3123.33ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1050: loss 1.4412, time 3551.74ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1060: loss 1.4274, time 3628.33ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1070: loss 1.4290, time 4224.91ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1080: loss 1.4361, time 3568.74ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1090: loss 1.4219, time 3846.13ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1100: loss 1.3970, time 4024.95ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1110: loss 1.4360, time 3764.48ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1120: loss 1.3991, time 3430.88ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1130: loss 1.3780, time 3599.72ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1140: loss 1.4124, time 4869.01ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1150: loss 1.3869, time 4361.28ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1160: loss 1.3866, time 3284.92ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1170: loss 1.4053, time 4335.68ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1180: loss 1.3735, time 3384.48ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1190: loss 1.3663, time 3845.99ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1200: loss 1.3592, time 3454.56ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1210: loss 1.3649, time 4189.60ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1220: loss 1.3588, time 3419.71ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1230: loss 1.3371, time 3565.48ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1240: loss 1.3338, time 5029.18ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
step 1250: train loss 1.2253, val loss 1.3181
saving checkpoint to out-shakespeare-char
iter 1250: loss 1.3215, time 379278.48ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1260: loss 1.3056, time 4575.33ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1270: loss 1.3311, time 3698.40ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1280: loss 1.3251, time 4393.26ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1290: loss 1.3225, time 3579.44ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1300: loss 1.2884, time 4446.99ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1310: loss 1.2755, time 3598.54ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1320: loss 1.2550, time 3152.21ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1330: loss 1.2647, time 3608.09ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1340: loss 1.2383, time 3610.59ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1350: loss 1.2424, time 3434.89ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1360: loss 1.2235, time 3738.01ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1370: loss 1.2059, time 3681.08ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1380: loss 1.1977, time 3238.11ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1390: loss 1.1621, time 3631.33ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1400: loss 1.1753, time 3943.26ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1410: loss 1.1658, time 3412.86ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1420: loss 1.1410, time 4237.88ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1430: loss 1.1314, time 3467.50ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1440: loss 1.1134, time 4381.71ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1450: loss 1.1025, time 3363.12ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1460: loss 1.0886, time 4381.80ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1470: loss 1.0794, time 3628.09ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1480: loss 1.0722, time 4008.26ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1490: loss 1.0535, time 3310.30ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
step 1500: train loss 0.8381, val loss 0.9416
saving checkpoint to out-shakespeare-char
iter 1500: loss 1.0383, time 376796.56ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1510: loss 1.0260, time 3552.89ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1520: loss 1.0092, time 4370.59ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1530: loss 0.9952, time 3628.52ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1540: loss 1.0047, time 3672.66ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1550: loss 0.9809, time 3692.99ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1560: loss 0.9772, time 3756.31ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1570: loss 0.9422, time 3162.31ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1580: loss 0.9473, time 3435.96ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1590: loss 0.9184, time 3471.70ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1600: loss 0.9380, time 3636.21ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1610: loss 0.9100, time 3517.51ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1620: loss 0.8701, time 3417.10ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1630: loss 0.8922, time 3633.98ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1640: loss 0.8664, time 2958.21ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1650: loss 0.8845, time 3682.92ms, mfu 0.23%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1660: loss 0.8705, time 4619.23ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1670: loss 0.8495, time 5572.28ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1680: loss 0.8575, time 3392.63ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1690: loss 0.8340, time 4540.96ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1700: loss 0.8362, time 3437.25ms, mfu 0.22%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1710: loss 0.8378, time 4082.23ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1720: loss 0.8094, time 3999.01ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1730: loss 0.7970, time 3913.58ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1740: loss 0.7843, time 6382.32ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
step 1750: train loss 0.5482, val loss 0.6621
saving checkpoint to out-shakespeare-char
iter 1750: loss 0.7973, time 392719.05ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1760: loss 0.7823, time 4009.44ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1770: loss 0.7666, time 4675.73ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1780: loss 0.7697, time 4546.71ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1790: loss 0.7730, time 4380.09ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1800: loss 0.7602, time 4300.94ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1810: loss 0.7580, time 4178.40ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1820: loss 0.7441, time 4673.95ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1830: loss 0.7361, time 4594.90ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1840: loss 0.7299, time 4460.67ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1850: loss 0.7250, time 3999.88ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1860: loss 0.7069, time 4362.00ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1870: loss 0.7218, time 4040.71ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1880: loss 0.7050, time 3708.59ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1890: loss 0.6909, time 4318.46ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1900: loss 0.6972, time 3960.35ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1910: loss 0.6810, time 3840.07ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1920: loss 0.6772, time 3188.76ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1930: loss 0.6761, time 3948.76ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1940: loss 0.6720, time 3744.80ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1950: loss 0.6876, time 4116.35ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1960: loss 0.6900, time 4059.38ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1970: loss 0.6499, time 4361.85ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1980: loss 0.6683, time 4556.96ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 1990: loss 0.6530, time 3680.67ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
step 2000: train loss 0.3994, val loss 0.5190
saving checkpoint to out-shakespeare-char
iter 2000: loss 0.6446, time 401048.36ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2010: loss 0.6306, time 4409.37ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2020: loss 0.6253, time 3915.89ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2030: loss 0.6449, time 3890.91ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2040: loss 0.6223, time 4112.75ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2050: loss 0.6206, time 4298.39ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2060: loss 0.6073, time 3620.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2070: loss 0.6081, time 5001.53ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2080: loss 0.5871, time 4103.19ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2090: loss 0.6073, time 5622.74ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2100: loss 0.6080, time 4539.73ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2110: loss 0.6011, time 4366.06ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2120: loss 0.5947, time 4024.67ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2130: loss 0.5830, time 4273.92ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2140: loss 0.5631, time 4251.86ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2150: loss 0.5761, time 4399.89ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2160: loss 0.5757, time 3784.92ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2170: loss 0.5726, time 4099.54ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2180: loss 0.5767, time 3671.18ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2190: loss 0.5608, time 3557.57ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2200: loss 0.5495, time 4095.41ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2210: loss 0.5558, time 5146.29ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2220: loss 0.5436, time 4098.62ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2230: loss 0.5549, time 4079.21ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2240: loss 0.5408, time 4143.27ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
step 2250: train loss 0.2951, val loss 0.4160
saving checkpoint to out-shakespeare-char
iter 2250: loss 0.5283, time 402602.13ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2260: loss 0.5366, time 4008.21ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2270: loss 0.5290, time 10835.39ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2280: loss 0.5315, time 2843.09ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2290: loss 0.5124, time 5363.33ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2300: loss 0.5247, time 3655.92ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2310: loss 0.4960, time 3120.61ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2320: loss 0.5102, time 4171.69ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2330: loss 0.5017, time 4100.52ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2340: loss 0.5059, time 4201.16ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2350: loss 0.5040, time 4606.30ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2360: loss 0.5153, time 4092.36ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2370: loss 0.5094, time 3726.91ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2380: loss 0.4930, time 4151.26ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2390: loss 0.4934, time 4739.18ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2400: loss 0.4953, time 3913.62ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2410: loss 0.4904, time 4052.75ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2420: loss 0.4798, time 4258.09ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2430: loss 0.4716, time 4232.94ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2440: loss 0.4718, time 4524.57ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2450: loss 0.4723, time 4648.63ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2460: loss 0.4708, time 3990.68ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2470: loss 0.4832, time 5042.96ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2480: loss 0.4587, time 3783.55ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2490: loss 0.4578, time 3622.56ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
step 2500: train loss 0.2267, val loss 0.3423
saving checkpoint to out-shakespeare-char
iter 2500: loss 0.4577, time 394579.41ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2510: loss 0.4582, time 4490.37ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2520: loss 0.4500, time 3747.02ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2530: loss 0.4502, time 4067.78ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2540: loss 0.4423, time 3832.56ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2550: loss 0.4547, time 3878.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2560: loss 0.4452, time 4033.42ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2570: loss 0.4397, time 4581.80ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2580: loss 0.4415, time 4071.08ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2590: loss 0.4262, time 4466.72ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2600: loss 0.4077, time 3589.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2610: loss 0.4377, time 3519.79ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2620: loss 0.4288, time 3464.20ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2630: loss 0.4251, time 3589.87ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2640: loss 0.4317, time 4152.46ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2650: loss 0.4287, time 4027.31ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2660: loss 0.4151, time 4042.33ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2670: loss 0.4072, time 4396.33ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2680: loss 0.4100, time 3587.34ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2690: loss 0.4147, time 3894.14ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2700: loss 0.4047, time 4249.30ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2710: loss 0.4148, time 5865.86ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2720: loss 0.3948, time 4332.92ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2730: loss 0.3974, time 5043.46ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2740: loss 0.3987, time 3924.16ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 2750: train loss 0.1789, val loss 0.2947
saving checkpoint to out-shakespeare-char
iter 2750: loss 0.3992, time 395196.68ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2760: loss 0.3929, time 4467.70ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2770: loss 0.3904, time 4565.31ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2780: loss 0.4041, time 4236.62ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2790: loss 0.3888, time 4226.72ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2800: loss 0.3864, time 4409.71ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2810: loss 0.3948, time 3886.56ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2820: loss 0.3881, time 3162.55ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2830: loss 0.3679, time 5028.57ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2840: loss 0.3749, time 4398.90ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2850: loss 0.3654, time 3972.76ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2860: loss 0.3633, time 4300.78ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2870: loss 0.3660, time 4245.70ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2880: loss 0.3700, time 5633.60ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2890: loss 0.3603, time 5131.94ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2900: loss 0.3745, time 5188.84ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2910: loss 0.3616, time 4404.18ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2920: loss 0.3662, time 4848.96ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2930: loss 0.3468, time 4890.98ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2940: loss 0.3667, time 3837.58ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2950: loss 0.3591, time 3354.88ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2960: loss 0.3503, time 4280.09ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2970: loss 0.3541, time 4407.38ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2980: loss 0.3431, time 4054.00ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 2990: loss 0.3475, time 4149.26ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 3000: train loss 0.1464, val loss 0.2591
saving checkpoint to out-shakespeare-char
iter 3000: loss 0.3254, time 382283.46ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3010: loss 0.3402, time 4323.70ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3020: loss 0.3360, time 3809.66ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3030: loss 0.3334, time 15411.14ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3040: loss 0.3294, time 4966.06ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3050: loss 0.3223, time 4822.87ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3060: loss 0.3272, time 3980.19ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3070: loss 0.3344, time 3832.46ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3080: loss 0.3415, time 3983.58ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3090: loss 0.3256, time 3953.19ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3100: loss 0.3195, time 3915.62ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3110: loss 0.3337, time 4100.29ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3120: loss 0.3136, time 3615.81ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3130: loss 0.3320, time 4499.43ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3140: loss 0.3224, time 3974.43ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3150: loss 0.3170, time 4007.27ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3160: loss 0.3193, time 4233.84ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3170: loss 0.3173, time 4256.60ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3180: loss 0.3264, time 3942.63ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3190: loss 0.3087, time 4546.33ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3200: loss 0.3134, time 4519.65ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3210: loss 0.3174, time 4243.92ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3220: loss 0.3006, time 3879.98ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3230: loss 0.2991, time 8699.93ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3240: loss 0.3090, time 3317.54ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 3250: train loss 0.1184, val loss 0.2222
saving checkpoint to out-shakespeare-char
iter 3250: loss 0.3057, time 398969.78ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3260: loss 0.3035, time 4263.22ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3270: loss 0.3044, time 4161.12ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3280: loss 0.3013, time 4494.29ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3290: loss 0.3070, time 4325.56ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3300: loss 0.3105, time 4062.68ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3310: loss 0.3031, time 4749.11ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3320: loss 0.2867, time 4305.99ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3330: loss 0.3037, time 3534.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3340: loss 0.3013, time 3560.28ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3350: loss 0.2928, time 4381.51ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3360: loss 0.2917, time 3776.94ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3370: loss 0.3019, time 4066.15ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3380: loss 0.2828, time 4151.22ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3390: loss 0.2863, time 4742.71ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3400: loss 0.2923, time 4177.67ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3410: loss 0.2883, time 3807.09ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3420: loss 0.2891, time 4431.86ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3430: loss 0.2835, time 4941.97ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3440: loss 0.2774, time 4356.50ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3450: loss 0.2799, time 4184.96ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3460: loss 0.2766, time 4402.33ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3470: loss 0.2775, time 3529.46ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3480: loss 0.2682, time 4323.04ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3490: loss 0.2764, time 4565.88ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 3500: train loss 0.1026, val loss 0.2042
saving checkpoint to out-shakespeare-char
iter 3500: loss 0.2702, time 400111.92ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3510: loss 0.2829, time 3560.64ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3520: loss 0.2730, time 3878.14ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3530: loss 0.2801, time 4405.77ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3540: loss 0.2735, time 3679.21ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3550: loss 0.2723, time 4630.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3560: loss 0.2730, time 4107.67ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3570: loss 0.2633, time 4214.73ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3580: loss 0.2707, time 4638.79ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3590: loss 0.2748, time 3614.70ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3600: loss 0.2606, time 4258.55ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3610: loss 0.2575, time 3645.99ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3620: loss 0.2592, time 3447.27ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3630: loss 0.2666, time 3479.09ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3640: loss 0.2547, time 3619.88ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3650: loss 0.2660, time 3630.73ms, mfu 0.21%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3660: loss 0.2559, time 5550.99ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3670: loss 0.2550, time 3760.48ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3680: loss 0.2454, time 7345.93ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3690: loss 0.2604, time 4200.85ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3700: loss 0.2617, time 4375.03ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3710: loss 0.2528, time 4590.62ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3720: loss 0.2615, time 4553.75ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3730: loss 0.2501, time 4077.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3740: loss 0.2557, time 4511.18ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 3750: train loss 0.0895, val loss 0.1909
saving checkpoint to out-shakespeare-char
iter 3750: loss 0.2497, time 378525.88ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3760: loss 0.2459, time 3912.09ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3770: loss 0.2587, time 4156.72ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3780: loss 0.2505, time 4094.10ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3790: loss 0.2400, time 4040.60ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3800: loss 0.2471, time 4312.82ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3810: loss 0.2489, time 4387.54ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3820: loss 0.2381, time 4147.07ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3830: loss 0.2304, time 3666.47ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3840: loss 0.2501, time 4746.59ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3850: loss 0.2438, time 3891.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3860: loss 0.2465, time 4149.60ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3870: loss 0.2326, time 4210.22ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3880: loss 0.2456, time 4361.77ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3890: loss 0.2383, time 3432.28ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3900: loss 0.2350, time 3856.02ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3910: loss 0.2290, time 4113.54ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3920: loss 0.2439, time 3717.84ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3930: loss 0.2384, time 3765.24ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3940: loss 0.2362, time 4001.45ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3950: loss 0.2371, time 4638.12ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3960: loss 0.2382, time 5524.22ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3970: loss 0.2393, time 4901.33ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3980: loss 0.2330, time 4069.45ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 3990: loss 0.2215, time 3592.98ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
step 4000: train loss 0.0790, val loss 0.1759
saving checkpoint to out-shakespeare-char
iter 4000: loss 0.2305, time 396427.11ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4010: loss 0.2332, time 4418.18ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4020: loss 0.2172, time 4229.46ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4030: loss 0.2361, time 4275.04ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4040: loss 0.2257, time 4018.36ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4050: loss 0.2353, time 4122.45ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4060: loss 0.2317, time 4329.04ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4070: loss 0.2281, time 4434.57ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4080: loss 0.2336, time 4897.77ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4090: loss 0.2347, time 3985.93ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4100: loss 0.2218, time 4510.73ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4110: loss 0.2175, time 4315.25ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4120: loss 0.2270, time 4235.87ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4130: loss 0.2244, time 4231.11ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4140: loss 0.2182, time 4731.88ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4150: loss 0.2196, time 4302.04ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4160: loss 0.2215, time 4279.79ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4170: loss 0.2141, time 5462.89ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4180: loss 0.2171, time 4054.01ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4190: loss 0.2169, time 4813.69ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4200: loss 0.2293, time 4245.07ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4210: loss 0.2232, time 5038.67ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4220: loss 0.2155, time 3909.38ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4230: loss 0.2135, time 4076.69ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4240: loss 0.2148, time 4669.31ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 4250: train loss 0.0719, val loss 0.1651
saving checkpoint to out-shakespeare-char
iter 4250: loss 0.2161, time 387245.91ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4260: loss 0.2115, time 4331.08ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4270: loss 0.2152, time 3807.41ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4280: loss 0.2115, time 3958.97ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4290: loss 0.2074, time 4347.00ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4300: loss 0.2127, time 4024.06ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4310: loss 0.2141, time 3661.63ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4320: loss 0.2077, time 3987.33ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4330: loss 0.2106, time 4022.08ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4340: loss 0.2121, time 4236.23ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4350: loss 0.2119, time 3952.57ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4360: loss 0.2038, time 3377.65ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4370: loss 0.2002, time 4219.41ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4380: loss 0.2099, time 3796.77ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4390: loss 0.1991, time 4199.20ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4400: loss 0.2084, time 4566.57ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4410: loss 0.2021, time 4124.56ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4420: loss 0.2044, time 4113.03ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4430: loss 0.2055, time 3330.63ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4440: loss 0.2048, time 4772.23ms, mfu 0.20%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4450: loss 0.2099, time 5225.44ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4460: loss 0.2077, time 5032.41ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4470: loss 0.2097, time 4030.41ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4480: loss 0.2021, time 4222.97ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4490: loss 0.2027, time 4566.69ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
step 4500: train loss 0.0659, val loss 0.1625
saving checkpoint to out-shakespeare-char
iter 4500: loss 0.1955, time 402133.15ms, mfu 0.17%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4510: loss 0.2040, time 3899.78ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4520: loss 0.2047, time 4310.12ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4530: loss 0.2170, time 4766.65ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4540: loss 0.1937, time 3438.07ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4550: loss 0.2031, time 3856.62ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4560: loss 0.2000, time 3551.87ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4570: loss 0.2004, time 3896.01ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4580: loss 0.1920, time 4075.22ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4590: loss 0.2048, time 4302.71ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4600: loss 0.1973, time 4805.05ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4610: loss 0.1995, time 4286.01ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4620: loss 0.1932, time 3855.21ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4630: loss 0.1982, time 5089.42ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4640: loss 0.1880, time 3620.02ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4650: loss 0.1905, time 4037.99ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4660: loss 0.2016, time 4269.15ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4670: loss 0.1934, time 6912.51ms, mfu 0.19%, MPS mem allocated=0.81GB, reserved=11.76GB
iter 4680: loss 0.1934, time 5625.11ms, mfu 0.18%, MPS mem allocated=0.81GB, reserved=11.76GB